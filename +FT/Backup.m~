function Backup(varargin)

% FT.Backup
%
% Description: back up (tar/gzip) the +ex folder to the 'learn_matlab/_bak' directory
%
% Syntax: ex.Backup([force]=false)
%
% In: 
%       [force] - true to force processing where output exists
%
% Out: 
%
% Updated: 2013-12-18
% Scottie Alexander
%
% Please report bugs to: scottiealexander11@gmail.com

strDirOut = '/mnt/tsestorage/scottie/HNP/fieldtrip_gui';


if ~isempty(varargin)
    if isnumeric(varargin{1})
        bForce = logical(varargin{1});
    elseif islogical(varargin{1})
        bForce = varargin{1};
    else
        error('invalid value specified for force option, value should be TRUE or FALSE');
    end
else
    bForce = false;
end        

strDirBase = fileparts(fileparts(mfilename('fullpath')));

strDirBak = fullfile(strDirOut,'_bak');

strNameOut = ['+FT_' strrep(datestr(now,29),'-','') '.tar.gz'];

strPathOut = fullfile(strDirBak,strNameOut);

if exist(strPathOut,'file')==2 && ~bForce
    fprintf('+FT directory is already backed up!\n');
else
    system(['rm -rf ' strPathOut]);
    
    fprintf('backing up +FT directory...\n');
    if system(['cd ' strDirBase '; tar --create --gzip --file=' strNameOut  ' +FT'])
        error('failed to back up +FT directory');
    end
    if ~movefile(fullfile(strDirBase,strNameOut),strDirBak)
        error('failed to move tar file to _bak dir');
    end
    fprintf('done!\n');
end

fprintf('backing up +FT directory...\n');
if system(['cd ' strDirBase '; tar --create --gzip --file=' strNameOut  ' +FT'])
    error('failed to back up +FT directory');
end
if ~movefile(fullfile(strDirBase,strNameOut),strDirBak)
    error('failed to move tar file to _bak dir');
end
